function Banners(){this.$bannerListGroup=$(".banner-list-group"),Banners.$image=null}$(function(){(new Banners).run()}),Banners.prototype.run=function(){this.loadData(),this.listenAddBannerEvent()},Banners.prototype.loadData=function(){var e=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){200==n.code&&n.data.forEach(function(n){e.createBannerItem(n)})}})},Banners.prototype.listenAddBannerEvent=function(){var n=this;$("#add-banner-btn").click(function(){6<=n.$bannerListGroup.children().length?window.messageBox.showInfo("最多只能添加6张轮播图!"):n.createBannerItem()})},Banners.prototype.createBannerItem=function(n){var e=this,a=template("banner-item",{banner:n});if(n){e.$bannerListGroup.append(a);var t=e.$bannerListGroup.find(".banner-item:last")}else{e.$bannerListGroup.prepend(a);t=e.$bannerListGroup.find(".banner-item:first")}e.addImageSelectEvent(t),e.addRemoveBannerEvent(t),e.addSaveBannerEvent(t)},Banners.prototype.addImageSelectEvent=function(n){var o=this;Banners.$image=n.find(".thumbnail"),n.find(".image-input").change(function(){var i=this.files[0];xfzajax.get({url:"/cms/qntoken/",success:function(n){if(200==n.code){var e=n.data.token,a=(new Date).getTime()+"."+i.name.split(".")[1],t={fname:a,params:{},mimeType:["image/gif","image/png","image/jpeg","image/bmp","image/webp"]},r={useCdnDomain:!0,retryCount:6,region:qiniu.region.z2};qiniu.upload(i,a,e,t,r).subscribe({error:o.handleFileUploadError,complete:o.handleFileUploadComplete})}}})})},Banners.prototype.addRemoveBannerEvent=function(e){e.find(".close-btn").click(function(){var n=e.attr("data-banner-pk");n?xfzalert.alertConfirm({text:"确定要删除这个轮播图吗？",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{bannerpk:n},success:function(n){200==n.code&&(e.remove(),window.messageBox.showSuccess("轮播图删除成功！"))}})}}):e.remove()})},Banners.prototype.addSaveBannerEvent=function(i){var o=i.find("input[name='priority']"),s=i.find("input[name='link_to']"),c=i.find("span.priority"),n=i.find(".save-btn");Banners.$image=i.find(".thumbnail"),n.click(function(){var e=i.attr("data-banner-pk");if(e)var n="/cms/edit_banner/";else n="/cms/add_banner/";var a=Banners.$image.attr("src"),t=o.val(),r=s.val();xfzajax.post({url:n,data:{pk:e,priority:t,image_url:a,link_to:r},success:function(n){200==n.code&&(e?window.messageBox.showSuccess("轮播图修改完成"):(e=n.data.banner_pk,i.attr({"data-banner-pk":e}),window.messageBox.showSuccess("轮播图添加完成")),c.text("优先级："+t))}})})},Banners.prototype.handleFileUploadError=function(n){window.messageBox.showError(n.message)},Banners.prototype.handleFileUploadComplete=function(n){var e="http://pimlatbwn.bkt.clouddn.com/"+n.key;Banners.$image.attr({src:e})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInRoaXMiLCIkYmFubmVyTGlzdEdyb3VwIiwiJCIsIiRpbWFnZSIsInJ1biIsInByb3RvdHlwZSIsImxvYWREYXRhIiwibGlzdGVuQWRkQmFubmVyRXZlbnQiLCJzZWxmIiwieGZ6YWpheCIsImdldCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJmb3JFYWNoIiwiYmFubmVyIiwiY3JlYXRlQmFubmVySXRlbSIsImNsaWNrIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJ3aW5kb3ciLCJtZXNzYWdlQm94Iiwic2hvd0luZm8iLCJ0cGwiLCJ0ZW1wbGF0ZSIsImFwcGVuZCIsIiRiYW5uZXJJdGVtIiwiZmluZCIsInByZXBlbmQiLCJhZGRJbWFnZVNlbGVjdEV2ZW50IiwiYWRkUmVtb3ZlQmFubmVyRXZlbnQiLCJhZGRTYXZlQmFubmVyRXZlbnQiLCJjaGFuZ2UiLCJmaWxlIiwiZmlsZXMiLCJ0b2tlbiIsImtleSIsIkRhdGUiLCJnZXRUaW1lIiwibmFtZSIsInNwbGl0IiwicHV0RXh0cmEiLCJmbmFtZSIsInBhcmFtcyIsIm1pbWVUeXBlIiwiY29uZmlnIiwidXNlQ2RuRG9tYWluIiwicmV0cnlDb3VudCIsInJlZ2lvbiIsInFpbml1IiwiejIiLCJ1cGxvYWQiLCJzdWJzY3JpYmUiLCJlcnJvciIsImhhbmRsZUZpbGVVcGxvYWRFcnJvciIsImNvbXBsZXRlIiwiaGFuZGxlRmlsZVVwbG9hZENvbXBsZXRlIiwiYmFubmVycGsiLCJhdHRyIiwieGZ6YWxlcnQiLCJhbGVydENvbmZpcm0iLCJ0ZXh0IiwiY29uZmlybUNhbGxiYWNrIiwicG9zdCIsImRhdGEiLCJyZW1vdmUiLCJzaG93U3VjY2VzcyIsIiRwcmlvcml0eSIsIiRsaW5rdG8iLCIkcHJpb3JpdHlTcGFuIiwiJHNhdmVCdG4iLCJpbWFnZV91cmwiLCJwcmlvcml0eSIsInZhbCIsImxpbmtfdG8iLCJwayIsImRhdGEtYmFubmVyLXBrIiwic2hvd0Vy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QU0sV0FDWCxJQUFJd0MsRUFBUy9CLEVBQVlnQyxLQUFLLGtCQUM5QixHQUFHRCxFQUNDLElBQUk5QyxFQUFJLHlCQUVKQSxFQUFJLG1CQUVaLElBQUk0RCxFQUFVeEUsUUFBUUksT0FBT3VELEtBQUssT0FDOUJjLEVBQVNMLEVBQVVNLE1BQ25CQyxFQUFRTixFQUFRSyxNQUNwQmhFLFFBQVFzRCxLQUFLLENBQ1RwRCxJQUFPQSxFQUNQcUQsS0FBUSxDQUNKVyxHQUFNbEIsRUFDTmUsU0FBWUEsRUFDWkQsVUFBYUEsRUFDYkcsUUFBV0EsR0FFZjlELFFBQVcsU0FBU0MsR0FDRyxLQUFoQkEsRUFBYSxPQUNUNEMsRUFDQ3JDLE9BQU9DLFdBQVc2QyxZQUFZLFlBRTlCVCxFQUFTNUMsRUFBYSxLQUFhLFVBQ25DYSxFQUFZZ0MsS0FBSyxDQUFDa0IsaUJBQWtCbkIsSUFDcENyQyxPQUFPQyxXQUFXNkMsWUFBWSxZQUVsQ0csRUFBY1IsS0FBSyxPQUFPVyxVQU05Q3pFLFFBQVFNLFVBQVVpRCxzQkFBc0IsU0FBU0QsR0FDN0NqQyxPQUFPQyxXQUFXd0QsVUFBVXhCLEVBQU15QixVQUV0Qy9FLFFBQVFNLFVBQVVtRCx5QkFBeUIsU0FBU3VCLEdBQ2hELElBRUlwRSxFQUZPLG9DQUNFb0UsRUFBUzNDLElBRXRCckMsUUFBUUksT0FBT3VELEtBQUssQ0FBQ3NCLElBQU9yRSIsImZpbGUiOiJiYW5uZXJzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZnVuY3Rpb24oKXtcbiAgICB2YXIgYmFubmVycz1uZXcgQmFubmVycygpO1xuICAgIGJhbm5lcnMucnVuKCk7XG59KTtcbmZ1bmN0aW9uIEJhbm5lcnMoKXtcbiAgICB0aGlzLiRiYW5uZXJMaXN0R3JvdXA9JChcIi5iYW5uZXItbGlzdC1ncm91cFwiKTtcbiAgICBCYW5uZXJzLiRpbWFnZT1udWxsO1xufTtcbkJhbm5lcnMucHJvdG90eXBlLnJ1bj1mdW5jdGlvbigpe1xuICAgIHRoaXMubG9hZERhdGEoKTtcbiAgICB0aGlzLmxpc3RlbkFkZEJhbm5lckV2ZW50KCk7XG59O1xuQmFubmVycy5wcm90b3R5cGUubG9hZERhdGE9ZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZj10aGlzO1xuICAgIHhmemFqYXguZ2V0KHtcbiAgICAgICAgXCJ1cmxcIjogXCIvY21zL2Jhbm5lcl9saXN0L1wiLFxuICAgICAgICBcInN1Y2Nlc3NcIjogZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAgICAgICAgIGlmKHJlc3VsdFtcImNvZGVcIl09PTIwMCl7XG4gICAgICAgICAgICAgICAgdmFyIGJhbm5lcnM9cmVzdWx0W1wiZGF0YVwiXTtcbiAgICAgICAgICAgICAgICBiYW5uZXJzLmZvckVhY2goZnVuY3Rpb24oYmFubmVyKXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jcmVhdGVCYW5uZXJJdGVtKGJhbm5lcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IFxuICAgICAgICB9XG4gICAgfSlcbn07XG5CYW5uZXJzLnByb3RvdHlwZS5saXN0ZW5BZGRCYW5uZXJFdmVudD1mdW5jdGlvbigpe1xuICAgIHZhciBzZWxmPXRoaXM7XG4gICAgdmFyICRhZGRCdG49JChcIiNhZGQtYmFubmVyLWJ0blwiKTtcbiAgICAkYWRkQnRuLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBiYW5uZXJJdGVtTGVuPXNlbGYuJGJhbm5lckxpc3RHcm91cC5jaGlsZHJlbigpLmxlbmd0aDtcbiAgICAgICAgaWYoYmFubmVySXRlbUxlbj49Nil7XG4gICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93SW5mbyhcIuacgOWkmuWPquiDvea3u+WKoDblvKDova7mkq3lm74hXCIpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHNlbGYuY3JlYXRlQmFubmVySXRlbSgpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuQmFubmVycy5wcm90b3R5cGUuY3JlYXRlQmFubmVySXRlbT1mdW5jdGlvbihiYW5uZXIpe1xuICAgIHZhciBzZWxmPXRoaXM7XG4gICAgdmFyIHRwbD10ZW1wbGF0ZShcImJhbm5lci1pdGVtXCIse1wiYmFubmVyXCI6YmFubmVyfSk7XG4gICAgaWYoYmFubmVyKXtcbiAgICAgICAgc2VsZi4kYmFubmVyTGlzdEdyb3VwLmFwcGVuZCh0cGwpO1xuICAgICAgICB2YXIgJGJhbm5lckl0ZW09c2VsZi4kYmFubmVyTGlzdEdyb3VwLmZpbmQoXCIuYmFubmVyLWl0ZW06bGFzdFwiKTtcbiAgICB9ZWxzZXtcbiAgICAgICAgc2VsZi4kYmFubmVyTGlzdEdyb3VwLnByZXBlbmQodHBsKTtcbiAgICAgICAgdmFyICRiYW5uZXJJdGVtPXNlbGYuJGJhbm5lckxpc3RHcm91cC5maW5kKFwiLmJhbm5lci1pdGVtOmZpcnN0XCIpO1xuICAgIH1cbiAgICBzZWxmLmFkZEltYWdlU2VsZWN0RXZlbnQoJGJhbm5lckl0ZW0pO1xuICAgIHNlbGYuYWRkUmVtb3ZlQmFubmVyRXZlbnQoJGJhbm5lckl0ZW0pO1xuICAgIHNlbGYuYWRkU2F2ZUJhbm5lckV2ZW50KCRiYW5uZXJJdGVtKTtcbn07XG5CYW5uZXJzLnByb3RvdHlwZS5hZGRJbWFnZVNlbGVjdEV2ZW50PWZ1bmN0aW9uKCRiYW5uZXJJdGVtKXtcbiAgICB2YXIgc2VsZj10aGlzO1xuICAgIEJhbm5lcnMuJGltYWdlPSRiYW5uZXJJdGVtLmZpbmQoXCIudGh1bWJuYWlsXCIpO1xuICAgIHZhciAkaW1hZ2VJbnB1dD0kYmFubmVySXRlbS5maW5kKFwiLmltYWdlLWlucHV0XCIpO1xuICAgICRpbWFnZUlucHV0LmNoYW5nZShmdW5jdGlvbigpe1xuICAgICAgICB2YXIgZmlsZT10aGlzLmZpbGVzWzBdO1xuICAgICAgICB4ZnphamF4LmdldCh7XG4gICAgICAgICAgICBcInVybFwiOiBcIi9jbXMvcW50b2tlbi9cIixcbiAgICAgICAgICAgIFwic3VjY2Vzc1wiOiBmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFtcImNvZGVcIl09PTIwMCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbj1yZXN1bHRbXCJkYXRhXCJdW1widG9rZW5cIl07XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXk9KG5ldyBEYXRlKCkpLmdldFRpbWUoKSsnLicrZmlsZS5uYW1lLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBwdXRFeHRyYT17XG4gICAgICAgICAgICAgICAgICAgICAgICBmbmFtZToga2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBbXCJpbWFnZS9naWZcIiwgXCJpbWFnZS9wbmdcIiwgXCJpbWFnZS9qcGVnXCIsIFwiaW1hZ2UvYm1wXCIsIFwiaW1hZ2Uvd2VicFwiXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlnPXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUNkbkRvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHJ5Q291bnQ6IDYsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb246IHFpbml1LnJlZ2lvbi56MlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBvYnNlcnZhYmxlPXFpbml1LnVwbG9hZChmaWxlLCBrZXksIHRva2VuLCBwdXRFeHRyYSwgY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXJyb3JcIjogc2VsZi5oYW5kbGVGaWxlVXBsb2FkRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21wbGV0ZVwiOiBzZWxmLmhhbmRsZUZpbGVVcGxvYWRDb21wbGV0ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSk7XG59O1xuQmFubmVycy5wcm90b3R5cGUuYWRkUmVtb3ZlQmFubmVyRXZlbnQ9ZnVuY3Rpb24oJGJhbm5lckl0ZW0pe1xuICAgIHZhciAkY2xvc2VCdG49JGJhbm5lckl0ZW0uZmluZChcIi5jbG9zZS1idG5cIik7XG4gICAgJGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBiYW5uZXJwaz0kYmFubmVySXRlbS5hdHRyKFwiZGF0YS1iYW5uZXItcGtcIik7XG4gICAgICAgIGlmKGJhbm5lcnBrKXtcbiAgICAgICAgICAgIHhmemFsZXJ0LmFsZXJ0Q29uZmlybSh7XG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwi56Gu5a6a6KaB5Yig6Zmk6L+Z5Liq6L2u5pKt5Zu+5ZCX77yfXCIsXG4gICAgICAgICAgICAgICAgXCJjb25maXJtQ2FsbGJhY2tcIjogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IFwiL2Ntcy9kZWxldGVfYmFubmVyL1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJhbm5lcnBrXCI6IGJhbm5lcnBrXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWNjZXNzXCI6IGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0W1wiY29kZVwiXT09MjAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJhbm5lckl0ZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi6L2u5pKt5Zu+5Yig6Zmk5oiQ5Yqf77yBXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgJGJhbm5lckl0ZW0ucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgfSk7XG59O1xuQmFubmVycy5wcm90b3R5cGUuYWRkU2F2ZUJhbm5lckV2ZW50PWZ1bmN0aW9uKCRiYW5uZXJJdGVtKXtcbiAgICB2YXIgJHByaW9yaXR5PSRiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdwcmlvcml0eSddXCIpOyBcbiAgICB2YXIgJGxpbmt0bz0kYmFubmVySXRlbS5maW5kKFwiaW5wdXRbbmFtZT0nbGlua190byddXCIpOyBcbiAgICB2YXIgJHByaW9yaXR5U3Bhbj0kYmFubmVySXRlbS5maW5kKFwic3Bhbi5wcmlvcml0eVwiKTtcbiAgICB2YXIgJHNhdmVCdG49JGJhbm5lckl0ZW0uZmluZChcIi5zYXZlLWJ0blwiKTtcbiAgICBCYW5uZXJzLiRpbWFnZT0kYmFubmVySXRlbS5maW5kKFwiLnRodW1ibmFpbFwiKTtcbiAgICAkc2F2ZUJ0bi5jbGljayhmdW5jdGlvbigpe1xuICAgICAgICB2YXIgYmFubmVycGs9JGJhbm5lckl0ZW0uYXR0cihcImRhdGEtYmFubmVyLXBrXCIpO1xuICAgICAgICBpZihiYW5uZXJwayl7XG4gICAgICAgICAgICB2YXIgdXJsPVwiL2Ntcy9lZGl0X2Jhbm5lci9cIjtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB2YXIgdXJsPVwiL2Ntcy9hZGRfYmFubmVyL1wiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbWFnZV91cmw9QmFubmVycy4kaW1hZ2UuYXR0cihcInNyY1wiKTtcbiAgICAgICAgdmFyIHByaW9yaXR5PSRwcmlvcml0eS52YWwoKTtcbiAgICAgICAgdmFyIGxpbmtfdG89JGxpbmt0by52YWwoKTtcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgIFwidXJsXCI6IHVybCxcbiAgICAgICAgICAgIFwiZGF0YVwiOiB7XG4gICAgICAgICAgICAgICAgXCJwa1wiOiBiYW5uZXJwayxcbiAgICAgICAgICAgICAgICBcInByaW9yaXR5XCI6IHByaW9yaXR5LFxuICAgICAgICAgICAgICAgIFwiaW1hZ2VfdXJsXCI6IGltYWdlX3VybCxcbiAgICAgICAgICAgICAgICBcImxpbmtfdG9cIjogbGlua190b1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwic3VjY2Vzc1wiOiBmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFtcImNvZGVcIl09PTIwMCl7XG4gICAgICAgICAgICAgICAgICAgIGlmKGJhbm5lcnBrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi6L2u5pKt5Zu+5L+u5pS55a6M5oiQXCIpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lcnBrPXJlc3VsdFtcImRhdGFcIl1bXCJiYW5uZXJfcGtcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgICRiYW5uZXJJdGVtLmF0dHIoe1wiZGF0YS1iYW5uZXItcGtcIjogYmFubmVycGt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi6L2u5pKt5Zu+5re75Yqg5a6M5oiQXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRwcmlvcml0eVNwYW4udGV4dChcIuS8mOWFiOe6p++8mlwiK3ByaW9yaXR5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcbkJhbm5lcnMucHJvdG90eXBlLmhhbmRsZUZpbGVVcGxvYWRFcnJvcj1mdW5jdGlvbihlcnJvcil7XG4gICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0Vycm9yKGVycm9yLm1lc3NhZ2UpO1xufTtcbkJhbm5lcnMucHJvdG90eXBlLmhhbmRsZUZpbGVVcGxvYWRDb21wbGV0ZT1mdW5jdGlvbihyZXNwb25zZSl7XG4gICAgdmFyIGRvbWFpbj0naHR0cDovL3BpbWxhdGJ3bi5ia3QuY2xvdWRkbi5jb20vJ1xuICAgIHZhciBmaWxlbmFtZT1yZXNwb25zZS5rZXk7XG4gICAgdmFyIHVybD1kb21haW4rZmlsZW5hbWU7XG4gICAgQmFubmVycy4kaW1hZ2UuYXR0cih7XCJzcmNcIjogdXJsfSk7XG59O1xuIl19
